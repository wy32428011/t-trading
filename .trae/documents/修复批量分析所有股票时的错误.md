# 修复批量分析所有股票时的错误

## 问题分析

运行 `python main.py --all` 时出现错误：`sequence item 52: expected str instance, NoneType found`。

### 错误原因

1. 错误发生在 `批量获取 6001 只股票的实时数据...` 之后
2. 错误类型是字符串拼接错误，表明在某个序列中包含 None 值
3. 查看代码流程：
   - `main.py` 中生成 `full_codes = [info['full_code'] for code, info in stock_infos.items() if info]`
   - 这个列表被传递给 `get_multiple_stocks_data` 方法
   - 该方法执行 `url = self.base_url.format(",".join(batch_codes))`
   - 如果 `batch_codes` 中包含 None 值，就会导致 `join` 方法出错

### 根本原因

`stock_infos` 中有些股票的 `full_code` 为 None，而 `full_codes` 列表没有过滤掉这些 None 值，导致后续的字符串拼接失败。

## 修复方案

### 方案1：在 `main.py` 中过滤掉 `full_code` 为 None 的情况

修改 `main.py` 中的 `analyze_multiple_stocks` 方法，在生成 `full_codes` 列表时，过滤掉 `full_code` 为 None 的情况。

### 方案2：在 `get_multiple_stocks_data` 方法中添加对 None 值的过滤

修改 `realtime_stock_data.py` 中的 `get_multiple_stocks_data` 方法，在处理 `stock_codes` 之前，过滤掉其中的 None 值。

## 实施步骤

1. 选择方案1，在 `main.py` 中修复，因为这样可以确保传递给 `get_multiple_stocks_data` 方法的 `stock_codes` 列表中只包含有效的字符串
2. 修改 `full_codes` 的生成逻辑，添加对 `info['full_code']` 的检查
3. 测试修复后的代码，确保能够成功运行 `python main.py --all`

## 预期效果

修复后，系统能够成功分析所有股票，不再出现 `sequence item 52: expected str instance, NoneType found` 错误。